import vk_api
from vk_api import VkApi
from vk_api.bot_longpoll import VkBotLongPoll, VkBotEventType, VkBotMessageEvent
from vk_api.utils import get_random_id
import random
import sys

sys.path.insert(0, "Data/Config")
import connection

token=connection.token  #–¢–û–ö–ï–ù –ì–†–£–ü–ü–´
access_token = connection.access_token
group_id = connection.group_id

vk_session = VkApi(token = token)
vk_session2 = VkApi(token = access_token)
longpoll = VkBotLongPoll(vk_session, group_id)
longpollbot = True

def write_message(sender, message, send):
	if send == 1:
		vk_session.method('messages.send', {'chat_id': sender, 'random_id': get_random_id(), 'message': message})
	elif send == 0:
		vk_session.method('messages.send', {'user_id': sender, 'random_id': get_random_id(), 'message': message})


def start(sender, text, send, user, name, surname):
	try:
		text = text.split(" ", 1)
		text = text[1]
		message = f"üì´–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å [id{str(user)}|{name} {surname}] –æ—Ç–ø—Ä–∞–≤–∏–ª(–∞) —Å–æ–æ–±—â–µ–Ω–∏–µ! \n‚úâ–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è: \n\n{text}"
		vk_session.method('messages.send', {'chat_id': 23, 'random_id': get_random_id(), 'message': message})
		write_message(sender, "üì´–°–æ–æ–±—â–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏!", send)
	except:
		write_message(sender, "–ø—Ä–æ–∏–∑–æ—à–ª–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞!", send)